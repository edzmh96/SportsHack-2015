<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Simple markers</title>
    <link rel="stylesheet" href="/eventspage/bootstrap.min.css"
          type="text/css"/>
    <link href="/eventspage/bootstrap-glyphicons.css" rel="stylesheet">
    <script src="/sweetalert.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../sweetalert.css">
    <style>
        div {
            margin: 0;
            padding: 0;
            border: 0;
            font-size: 100%;
            font: inherit;
            vertical-align: baseline;
        }

        .outer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 70px;
            background-color: grey;
            margin: 0;
            padding: 0;
        }

        /* HTML5 display-role reset for older browsers */

        body {
            line-height: 1;
        }

        ol, ul {
            list-style: none;
        }

        blockquote, q {
            quotes: none;
        }

        blockquote:before, blockquote:after,
        q:before, q:after {
            content: '';
            content: none;
        }

        table {
            border-collapse: collapse;
            border-spacing: 0;
        }

        .page-wrap {
            min-height: 100%;
            /* equal to footer height */
            margin-bottom: -30px;
        }

        .page-wrap:after {
            content: "";
            display: block;
        }

        .footer, .push {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 45px;
            clear: both;
        }

        .site-footer, .page-wrap:after {
            height: 30px;
        }

        .site-footer {
            background: orange;
        }

        html, body {
            height: 100%;
        }

    </style>
</head>
<body ng-app="sports">

<div class="page-wrap" id="myctrl" ng-controller="mainCtrl">
    <div style="height: 100px;width: 100%;background: red">

    </div>
    <div class="container-fuild" style="height: 500px; margin:0 auto; width: 960px;">

        <div class="row" style="height:100px;background: gray;">
            <h1>TI CATS VS TEST SHOWINGS</h1>
            <span>NEAR YOU:</span>
            <span>AT:</span>
        </div>
        <div class="row" style="height:40px;background: yellow;">

            <div class="col-md-3">
                <h4>FIND BY LOCATION:</h4>
            </div>
            <div class="col-md-9">


                <div class="input-group" style="padding: 3px 0">

                    <input class="form-control" ng-model="place" id="pac-input" type="text" placeholder="Search Box">
                    </input>
                    <span class="input-group-addon"><a href="#" ng-click="retrieveLocation()"
                                                       title="use my current location"
                                                       class="glyphicon glyphicon-screenshot"></a></span>

                </div>
            </div>

        </div>
        <div class="row" style="height: 100%;background: mintcream;">
            <!--<ul class="nav nav-tabs">-->
            <!--<li class="active"><a href="#">Events</a></li>-->
            <!--<li><a href="#">Places</a></li>-->
            <!--</ul>-->

            <div class="col-md-3" style="height: 100%;background:purple;padding:0;margin:0;">
                <ul id="listEvents" style="overflow-x: hidden; overflow-y:auto; list-style: none; list-style-type: none;padding:0;margin:0">
                    <li ng-repeat="obj in allEvents" ng-selected="obj.selected">
                        <div class="media" style="padding:10px;" ng-style="{background : ((obj.selected | filterTest) && 'teal') || ''}">
                            <div class="media-left"><a href="#"> <img class="media-object" data-src="holder.js/64x64"
                                                                      alt="64x64"
                                                                      src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+PCEtLQpTb3VyY2UgVVJMOiBob2xkZXIuanMvNjR4NjQKQ3JlYXRlZCB3aXRoIEhvbGRlci5qcyAyLjYuMC4KTGVhcm4gbW9yZSBhdCBodHRwOi8vaG9sZGVyanMuY29tCihjKSAyMDEyLTIwMTUgSXZhbiBNYWxvcGluc2t5IC0gaHR0cDovL2ltc2t5LmNvCi0tPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PCFbQ0RBVEFbI2hvbGRlcl8xNTE1MjllMmM1NCB0ZXh0IHsgZmlsbDojQUFBQUFBO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1mYW1pbHk6QXJpYWwsIEhlbHZldGljYSwgT3BlbiBTYW5zLCBzYW5zLXNlcmlmLCBtb25vc3BhY2U7Zm9udC1zaXplOjEwcHQgfSBdXT48L3N0eWxlPjwvZGVmcz48ZyBpZD0iaG9sZGVyXzE1MTUyOWUyYzU0Ij48cmVjdCB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIGZpbGw9IiNFRUVFRUUiLz48Zz48dGV4dCB4PSIxMy40Njg3NSIgeT0iMzYuMzk2ODc1Ij42NHg2NDwvdGV4dD48L2c+PC9nPjwvc3ZnPg=="
                                                                      data-holder-rendered="true"
                                                                      style="width: 64px; height: 64px;"> </a></div>
                            <div class="media-body"><h4 class="media-heading">Media heading</h4> Cras sit amet nibh
                                libero, in
                                gravida nulla. Nulla vel metus scelerisque ante sollicitudin commodo. Cras purus odio,
                            </div>
                        </div>
                    </li>
                </ul>


                <div class="outer">
                    <div ng-show="showPeopleStats">
                        <h5 style="margin: 10px 5px">DID YOU KNOW?</h5>

                        <div style="padding: 5px; text-align: left">
                            <span>There are </span>
                            <span>{{cflQtdPeople}}</span>
                            <span> fans of CFL on this area!</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-9" style="height:100%;background: teal;">


                <div id="map" style="width:100%;height:100%;">


                </div>
            </div>

        </div>

    </div>

</div>

<footer class="panel-footer push">

</footer>


<script src="/eventspage/angular.min.js"></script>
<script src="/eventspage/jquery.min.js"></script>
<script src="/eventspage/bootstrap.min.js"></script>
<script src="/eventspage/jquery.easing.min.js"></script>
<script src="/eventspage/wow.js"></script>

<script>

    var map = {};
    var geocoder = {};
    var searchBox = {};
    var inputBox = {};
    function focusOnSelectedEvent()
    {
        $("#listEvents").find("li:selected").focus();
    }

    function initMap() {
        var myLatLng = {lat: 43.2500, lng: -79.8667};

        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 14,
            center: myLatLng,
            streetViewControl: false
        });

        var marker = new google.maps.Marker({
            position: myLatLng,
            map: map,
            draggable: true,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        google.maps.event.addListener(marker, 'dragend', function (event) {
            var scope = angular.element(controllerElement).scope();
            if (scope && scope.isLoaded) {
                scope.lat = marker.position.lat();
                scope.long = marker.position.lng();
                scope.locationChanged();
            }
        });

        var circle = new google.maps.Circle({
            map: map,
            radius: 750,    // 10 miles in metres
            fillColor: '#AA0000'
        });
        circle.bindTo('center', marker, 'position');
        // Create the search box and link it to the UI element.
        inputBox = document.getElementById('pac-input');
        var searchBox = new google.maps.places.SearchBox(inputBox);

        // Bias the SearchBox results towards current map's viewport.
        map.addListener('bounds_changed', function () {
            searchBox.setBounds(map.getBounds());
        });

        var markers = [];
        markers.push(marker);
        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
        searchBox.addListener('places_changed', function () {
            var places = searchBox.getPlaces();

            if (places.length == 0) {
                return;
            }

            // Clear out the old markers.
            markers.forEach(function (marker) {
                marker.setMap(null);
            });
            markers = [];

            // For each place, get the icon, name and location.
            //var bounds = new google.maps.LatLngBounds();
            places.forEach(function (place) {
                var icon = {
                    url: place.icon,
                    size: new google.maps.Size(71, 71),
                    origin: new google.maps.Point(0, 0),
                    anchor: new google.maps.Point(17, 34),
                    scaledSize: new google.maps.Size(25, 25)
                };

                var newMarker = new google.maps.Marker({
                    map: map,
                    icon: icon,
                    title: place.name,
                    draggable: true,
                    position: place.geometry.location
                });
                google.maps.event.addListener(newMarker, 'dragend', function (event) {
                    var scope = angular.element(controllerElement).scope();
                    if (scope && scope.isLoaded) {
                        scope.lat = marker.position.lat();
                        scope.long = marker.position.lng();
                        scope.locationChanged();
                    }
                });

                circle.setMap(null);
                circle = new google.maps.Circle({
                    map: map,
                    radius: 750,
                    fillColor: '#AA0000'
                });
                circle.bindTo('center', newMarker, 'position');

                // Create a marker for each place.
                markers.push(newMarker);

//                if (place.geometry.viewport) {
                // Only geocodes have viewport.
//                    bounds.union(place.geometry.viewport);
//                } else {
//                    bounds.extend(place.geometry.location);
//                }
            });
            map.fitBounds(circle.getBounds());
            var scope = angular.element(controllerElement).scope();
            if (scope && scope.isLoaded) {
                scope.locationChanged();
            }
        });


        geocoder = new google.maps.Geocoder;


        var controllerElement = document.getElementById("myctrl");
        var scope = angular.element(controllerElement).scope();
        scope.mapLoaded();
    }

</script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyArEnkPX8RTQdsmgqsgokZ3PdTk7dcme1Q&signed_in=false&libraries=places&callback=initMap"></script>

<script src="../javascript/event.js"></script>
</body>
</html>